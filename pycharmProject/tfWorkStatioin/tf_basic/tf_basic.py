#!/usr/bin/env python
# coding:utf-8
"""
@version: 
@author: xiaojianli
@contact:xiaoli_lixj@163.com
@software: PyCharm
@time:  下午4:33
"""
import tensorflow as tf
import numpy as np
# 输入图片
input_data = tf.Variable(np.random.rand(10, 9, 9, 3), dtype=tf.float32) # batch:10 height:9 width:9 channels:3
# 定义滤波器
depthwise_filter = tf.Variable(np.random.rand(2, 2, 3, 5), dtype=tf.float32)   # filter_height:2 filter_width:2 channels: 3 卷积核个数：２
pointwise_filter = tf.Variable(np.random.rand(1, 1, 15, 20), dtype=tf.float32)# out_channels >= channel_multiplier * in_channels
op = tf.nn.separable_conv2d(input_data, depthwise_filter, pointwise_filter, strides=[1, 1, 1, 1], padding="SAME")
print("tf.nn.separable: ", tf.shape(op))    # shape=(10, 9, 9, 20)






























































































































































































































































# print("filter", filter_data)
##　tf.nn.conv2d()　卷积函数
#op = tf.nn.conv2d(input_data, filter_data, strides=[1, 1, 1, 1], padding='SAME')
# print(op.shape)  # (10, 9, 9, 2)

## tf.nn.depthwise_conv2d()
#op = tf.nn.depthwise_conv2d(input_data, filter_data, strides=[1, 1, 1, 1], padding='SAME')  #shape=(10, 9, 9, 15) 输出的总通道数为in_channels * channel_multipler

print("tf.nn.depthwise_conv2d(): ", op)